
- name: gather listen ports facts
  community.general.listen_ports_facts:
  tags:
    - node_bootstrap
    - firewall



- name: Add ports to firewall
  debug:
    msg: "{{ ansible_facts.tcp_listen }}"
  tags:
    - node_bootstrap
    - firewall



- name: Add ports to firewall
  debug:
    msg: "{{ item }}"
  loop: "{{ ansible_facts.tcp_listen }}"
  tags:
    - node_bootstrap
    - firewall



- name: Add ports to firewall
  debug:
    msg: "{{ item }}"
  loop: "{{ ansible_facts.tcp_listen  | map(attribute='port') }}"
  tags:
    - node_bootstrap
    - firewall



# - name: Add ports to firewall
#   debug:
#     msg: "{{ item }}"
#   loop: "{{ ansible_facts.tcp_listen  | map(attribute='port') | sort | list }}"
#   tags:
#     - node_bootstrap
#     - firewall



# - name: Add ports to firewall
#   debug:
#     msg: "{{ item }}"
#   loop: "{{ ansible_facts.tcp_listen }}"
#   tags:
#     - node_bootstrap
#     - firewall




